!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t=function(t,e,n,a=1){const o=t.getContext("2d"),i=(t=>(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1))(o);return t.width=e*i,t.height=n*i,t.style.width=e*a+"px",t.style.height=n*a+"px",o.setTransform(i,0,0,i,0,0),t};function e(t,e){const n=new Image;return n.src=t,e&&n.addEventListener("load",(()=>e(n)),!1),n}const n=(t,e,n,a=n)=>{const o=e.width/n;let i=0;return setInterval((()=>{i=(i+1)%o}),125),(o,r,d=1)=>t.drawImage(e,i*n,0,n,a,o*n,r*a,n,a)},a=e("img/tileset.png"),o=e("img/Characters/Bat.png"),i=e("img/Characters/Skeleton_idle.png"),r=e("img/Characters/Knight_idle.png"),d=e("img/Characters/Knight_idle_flip.png"),c=e("img/Characters/Slime (green).png"),s=e("img/Objects and traps/Gold coin.png");const l=(t,e,n,a)=>{const o=[];for(let i=e;i<a;i++)for(let e=t;e<n;e++)o.push([e,i]);return function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),a=t[e];t[e]=t[n],t[n]=a}}(o),o};let h,u,f,m,g,w,p,x,y,M,v,E,k,X,Y,b,C,S,R={};const B=16;function L(){C=!1,S=2;const t=l(1,1,7,9).filter((([t,e])=>Math.abs(t-y)>1||Math.abs(e-M)>1));[Y,b]=t.pop(),X=[{spr:u,x:Y,y:b}],[x,x,m,g,p].forEach((e=>{const[n,a]=t.pop();X.push({spr:e,x:n,y:a})}))}window.addEventListener("keydown",(function(t){R[t.keyCode]=!0})),window.addEventListener("keyup",(function(t){R[t.keyCode]=!1})),(t=>{let e=null,n=null;document.addEventListener("touchstart",(t=>{const a=t.touches[0];e=a.clientX,n=a.clientY}),!1),document.addEventListener("touchmove",(a=>{if(!e||!n)return;const o=a.touches[0].clientX,i=a.touches[0].clientY,r=e-o,d=n-i;Math.abs(r)>Math.abs(d)?t(r>0?37:39):t(d>0?38:40),e=null,n=null}),!1)})((t=>{R[t]=!0})),window.addEventListener("load",(function(){!function(){const e=document.getElementById("root");t(e,128,160,3),h=e.getContext("2d"),h.imageSmoothingEnabled=!1,f=((t,e,n,a=n)=>(o,i,r,d)=>t.drawImage(e,o*n,i*a,n,a,r*n,d*a,n,a))(h,a,B),m=n(h,o,B),g=n(h,i,B),w=[n(h,r,B),n(h,d,B)],p=n(h,c,B),x=n(h,s,B),u=(t,e)=>f(8,1,t,e),y=2,M=2,v=0}(),L(),_()}));const P={37:()=>{y>1&&y--,v=1},38:()=>{M>1&&M--},39:()=>{y<6&&y++,v=0},40:()=>{M<8&&M++}},I=(t,e)=>{const n=[];return t>1&&n.push([t-1,e]),e>1&&n.push([t,e-1]),t<6&&n.push([t+1,e]),e<8&&n.push([t,e+1]),(a=n)[Math.floor(Math.random()*a.length)];var a};function _(){C?S<1?S+=Math.min(1-S,1/15):L():(S>0&&(S-=Math.min(S,1/15)),y===Y&&M===b&&(C=!0)),C||Object.entries(P).forEach((([t,e])=>{R[t]&&(R[t]=!1,e(),X.slice(3).forEach((t=>{const[e,n]=I(t.x,t.y);t.x=e,t.y=n})))})),h.clearRect(0,0,128,160);for(let t=1;t<9;t++)for(let e=1;e<7;e++)f(1,1,e,t);f(0,0,0,0);for(let t=1;t<7;t++)f(1,0,t,0);f(2,0,7,0),f(0,2,0,9);for(let t=1;t<7;t++)f(1,2,t,9);f(2,2,7,9);for(let t=0;t<9;t++)f(0,1,0,t);for(let t=0;t<9;t++)f(2,1,7,t);X.forEach((t=>{void 0===t.drawX&&(t.drawX=t.x),void 0===t.drawY&&(t.drawY=t.y),t.drawX<t.x&&(t.drawX+=Math.min(t.x-t.drawX,.2)),t.drawY<t.y&&(t.drawY+=Math.min(t.y-t.drawY,.2)),t.drawX>t.x&&(t.drawX-=Math.min(t.drawX-t.x,.2)),t.drawY>t.y&&(t.drawY-=Math.min(t.drawY-t.y,.2)),t.spr(t.drawX,t.drawY)})),void 0===E&&(E=y),void 0===k&&(k=M),E<y&&(E+=Math.min(y-E,.2)),k<M&&(k+=Math.min(M-k,.2)),E>y&&(E-=Math.min(E-y,.2)),k>M&&(k-=Math.min(k-M,.2)),w[v](E,k),S>0&&(h.fillStyle=`rgba(39, 29, 42, ${S})`,h.fillRect(0,0,128,160)),requestAnimationFrame(_)}}));
