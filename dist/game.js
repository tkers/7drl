!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t=function(t,n,e,o=1){const i=t.getContext("2d"),a=(t=>(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1))(i);return t.width=n*a,t.height=e*a,t.style.width=n*o+"px",t.style.height=e*o+"px",i.setTransform(a,0,0,a,0,0),t};function n(t,n){const e=new Image;return e.src=t,n&&e.addEventListener("load",(()=>n(e)),!1),e}const e=(t,n,e,o=e)=>{const i=n.width/e;let a=0;return setInterval((()=>{a=(a+1)%i}),125),(i,r,d=1)=>t.drawImage(n,a*e,0,e,o,i*e,r*o,e,o)},o=n("img/tiles.png"),i=n("img/bat.png"),a=n("img/skeleton.png"),r=n("img/knight.png"),d=n("img/knight_flip.png"),c=n("img/slime.png"),s=n("img/coin.png");const l=(t,n,e,o)=>{const i=[];for(let a=n;a<o;a++)for(let n=t;n<e;n++)i.push([n,a]);return function(t){for(var n=t.length-1;n>0;n--){var e=Math.floor(Math.random()*(n+1)),o=t[n];t[n]=t[e],t[e]=o}}(i),i};let h,u,f,m,g,w,p,x,y,M,v,k,E,X,Y,b,R,S,L={};const P=16;function B(){R=!1,S=2;const t=l(1,1,7,9).filter((([t,n])=>Math.abs(t-y)>1||Math.abs(n-M)>1));[Y,b]=t.pop(),X=[{spr:u,x:Y,y:b}],[x,x,m,g,p].forEach((n=>{const[e,o]=t.pop();X.push({spr:n,x:e,y:o})}))}window.addEventListener("keydown",(function(t){L[t.keyCode]=!0})),window.addEventListener("keyup",(function(t){L[t.keyCode]=!1})),(t=>{let n=null,e=null;document.addEventListener("touchstart",(t=>{const o=t.touches[0];n=o.clientX,e=o.clientY}),!1),document.addEventListener("touchmove",(o=>{if(!n||!e)return;const i=o.touches[0].clientX,a=o.touches[0].clientY,r=n-i,d=e-a;Math.abs(r)>Math.abs(d)?t(r>0?37:39):t(d>0?38:40),n=null,e=null}),!1)})((t=>{L[t]=!0})),window.addEventListener("load",(function(){!function(){const n=document.getElementById("root");t(n,128,160,3),h=n.getContext("2d"),h.imageSmoothingEnabled=!1,f=((t,n,e,o=e)=>(i,a,r,d)=>t.drawImage(n,i*e,a*o,e,o,r*e,d*o,e,o))(h,o,P),m=e(h,i,P),g=e(h,a,P),w=[e(h,r,P),e(h,d,P)],p=e(h,c,P),x=e(h,s,P),u=(t,n)=>f(8,1,t,n),y=2,M=2,v=0}(),B(),j()}));const I={37:()=>{y>1&&y--,v=1},38:()=>{M>1&&M--},39:()=>{y<6&&y++,v=0},40:()=>{M<8&&M++}},C=(t,n)=>{const e=[];return t>1&&e.push([t-1,n]),n>1&&e.push([t,n-1]),t<6&&e.push([t+1,n]),n<8&&e.push([t,n+1]),(o=e)[Math.floor(Math.random()*o.length)];var o};function j(){R?S<1?S+=Math.min(1-S,1/15):B():(S>0&&(S-=Math.min(S,1/15)),y===Y&&M===b&&(R=!0)),R||Object.entries(I).forEach((([t,n])=>{L[t]&&(L[t]=!1,n(),X.slice(3).forEach((t=>{const[n,e]=C(t.x,t.y);t.x=n,t.y=e})))})),h.clearRect(0,0,128,160);for(let t=1;t<9;t++)for(let n=1;n<7;n++)f(1,1,n,t);f(0,0,0,0);for(let t=1;t<7;t++)f(1,0,t,0);f(2,0,7,0),f(0,2,0,9);for(let t=1;t<7;t++)f(1,2,t,9);f(2,2,7,9);for(let t=0;t<9;t++)f(0,1,0,t);for(let t=0;t<9;t++)f(2,1,7,t);X.forEach((t=>{void 0===t.drawX&&(t.drawX=t.x),void 0===t.drawY&&(t.drawY=t.y),t.drawX<t.x&&(t.drawX+=Math.min(t.x-t.drawX,.2)),t.drawY<t.y&&(t.drawY+=Math.min(t.y-t.drawY,.2)),t.drawX>t.x&&(t.drawX-=Math.min(t.drawX-t.x,.2)),t.drawY>t.y&&(t.drawY-=Math.min(t.drawY-t.y,.2)),t.spr(t.drawX,t.drawY)})),void 0===k&&(k=y),void 0===E&&(E=M),k<y&&(k+=Math.min(y-k,.2)),E<M&&(E+=Math.min(M-E,.2)),k>y&&(k-=Math.min(k-y,.2)),E>M&&(E-=Math.min(E-M,.2)),w[v](k,E),S>0&&(h.fillStyle=`rgba(39, 29, 42, ${S})`,h.fillRect(0,0,128,160)),requestAnimationFrame(j)}}));
